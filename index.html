<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Parent LifeHub – No Backend Needed</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/localforage@1.10.0/dist/localforage.min.js"></script>
  <style>
    body { font-family: system-ui; }
    [x-data] { display: none; }
    [x-show] { display: block !important; }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <div class="max-w-6xl mx-auto p-4">
    <h1 class="text-4xl font-bold text-indigo-700 mb-8">Parent LifeHub</h1>

    <!-- Tabs -->
    <div class="flex space-x-4 mb-6 overflow-x-auto">
      <button onclick="showTab('timeline')" class="tab-btn px-6 py-3 bg-indigo-600 text-white rounded-lg">Timeline</button>
      <button onclick="showTab('schools')" class="tab-btn px-6 py-3 bg-gray-200 rounded-lg">Schools</button>
      <button onclick="showTab('events')" class="tab-btn px-6 py-3 bg-gray-200 rounded-lg">Events & Fun</button>
      <button onclick="showTab('transport')" class="tab-btn px-6 py-3 bg-gray-200 rounded-lg">Transport</button>
      <button onclick="showTab('banking')" class="tab-btn px-6 py-3 bg-gray-200 rounded-lg">Banking</button>
    </div>

    <!-- 1. Timeline Planner -->
    <div id="timeline" class="tab-content">
      <h2 class="text-2xl font-bold mb-4">Your Child's Life Journey</h2>
      <div id="milestones"></div>
      <button onclick="addMilestone()" class="mt-4 bg-green-600 text-white px-4 py-2 rounded">+ Add Milestone</button>
    </div>

    <!-- 2. School Applications -->
    <div id="schools" class="tab-content hidden">
      <h2 class="text-2xl font-bold mb-4">School Applications</h2>
      <select id="schoolList" class="p-3 border rounded w-full mb-4"></select>
      <button onclick="applySchool()" class="bg-blue-600 text-white px-4 py-2 rounded">Apply / Save Progress</button>
      <div id="applications" class="mt-6"></div>
    </div>

    <!-- 3. Events (fetched from public Google Sheet) -->
    <div id="events" class="tab-content hidden">
      <h2 class="text-2xl font-bold mb-4">Fun Events & Activities</h2>
      <div id="eventsList" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
    </div>

    <!-- 4. Transport -->
    <div id="transport" class="tab-content hidden">
      <h2 class="text-2xl font-bold mb-4">Book a Ride</h2>
      <input type="text" id="pickup" placeholder="Pickup address" class="p-3 border rounded w-full mb-2">
      <input type="text" id="destination" placeholder="Destination (e.g. school)" class="p-3 border rounded w-full mb-4">
      <div class="flex space-x-4">
        <button onclick="bookUber()" class="bg-black text-white px-6 py-3 rounded">Uber</button>
        <button onclick="bookBolt()" class="bg-green-600 text-white px-6 py-3 rounded">Bolt/Taxify</button>
      </div>
    </div>

    <!-- 5. Banking -->
    <div id="banking" class="tab-content hidden">
      <h2 class="text-2xl font-bold mb-4">Quick Banking</h2>
      <div class="space-y-4">
        <button onclick="openBank('capitec')" class="w-full bg-purple-600 text-white py-4 rounded">Capitec</button>
        <button onclick="openBank('fnb')" class="w-full bg-green-700 text-white py-4 rounded">FNB</button>
        <button onclick="openBank('nedbank')" class="w-full bg-green-600 text-white py-4 rounded">Nedbank</button>
      </div>
    </div>
  </div>

<script>
// === Simple Alpine-like tab system ===
function showTab(tab) {
  document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('bg-indigo-600', 'text-white'));
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.add('bg-gray-200'));
  document.getElementById(tab).classList.remove('hidden');
  event.target.classList.remove('bg-gray-200');
  event.target.classList.add('bg-indigo-600', 'text-white');
}
showTab('timeline');

// === LocalStorage Helper ===
const db = localforage.createInstance({ name: "ParentLifeHub" });

// === 1. Timeline Milestones ===
const defaultMilestones = [
  { age: "Pregnancy", task: "First ultrasound", done: false },
  { age: "0-3 years", task: "Apply for preschool", done: false },
  { age: "4-6 years", task: "Grade R application", done: false },
  { age: "Grade 1", task: "Primary school application", done: false },
  { age: "Grade 8", task: "High school application", done: false },
  { age: "Grade 12", task: "University / Bursary applications", done: false },
  { age: "18+", task: "First job / Internship", done: false }
];

async function loadMilestones() {
  let milestones = await db.getItem('milestones') || defaultMilestones;
  const container = document.getElementById('milestones');
  container.innerHTML = milestones.map((m, i) => `
    <div class="bg-white p-4 rounded shadow mb-3 flex justify-between items-center">
      <div>
        <strong>\( {m.age}</strong>: \){m.task}
      </div>
      <input type="checkbox" \( {m.done ? 'checked' : ''} onchange="toggleMilestone( \){i})">
    </div>
  `).join('');
}
async function toggleMilestone(i) {
  let milestones = await db.getItem('milestones') || defaultMilestones;
  milestones[i].done = !milestones[i].done;
  await db.setItem('milestones', milestones);
  loadMilestones();
}
async function addMilestone() {
  let age = prompt("Age/Stage (e.g. Grade 10)");
  let task = prompt("Task (e.g. Choose subjects)");
  if (age && task) {
    let milestones = await db.getItem('milestones') || defaultMilestones;
    milestones.push({ age, task, done: false });
    await db.setItem('milestones', milestones);
    loadMilestones();
  }
}

// === 2. School Applications (example list) ===
const schools = [
  "Little Genius Preschool", "Sunshine Primary", "Westville High", "Stellenbosch University"
];
schools.forEach(s => {
  const opt = document.createElement('option');
  opt.value = s; opt.textContent = s;
  document.getElementById('schoolList').appendChild(opt);
});

async function applySchool() {
  const school = document.getElementById('schoolList').value;
  let apps = await db.getItem('applications') || [];
  if (!apps.includes(school)) {
    apps.push({ name: school, date: new Date().toLocaleDateString(), status: "Applied" });
    await db.setItem('applications', apps);
  }
  document.getElementById('applications').innerHTML = apps.map(a => `
    <div class="bg-blue-50 p-3 rounded mb-2">\( {a.name} – Applied \){a.date}</div>
  `).join('');
}

// === 3. Events (from public Google Sheet via Sheety) ===
fetch('https://api.sheety.co/YOUR_SHEETY_ID/events') // create free at sheety.co
  .then(r => r.json())
  .then(data => {
    document.getElementById('eventsList').innerHTML = data.events.map(e => `
      <div class="bg-white p-4 rounded shadow">
        <h3 class="font-bold">${e.name}</h3>
        <p>\( {e.date} | \){e.location}</p>
        <a href="${e.link}" class="text-indigo-600">Book →</a>
      </div>
    `).join('');
  });

// === 4. Transport Deep Links ===
function bookUber() {
  const pickup = encodeURIComponent(document.getElementById('pickup').value || "Current Location");
  const dest = encodeURIComponent(document.getElementById('destination').value);
  window.open(`uber://?action=setPickup&pickup=my_location&dropoff[formatted_address]=${dest}`);
}
function bookBolt() {
  const pickup = document.getElementById('pickup').value;
  const dest = document.getElementById('destination').value;
  window.open(`https://bolt.eu/en/cities/?pickup=\( {pickup}&destination= \){dest}`);
}

// === 5. Banking Deep Links (South Africa example) ===
function openBank(bank) {
  const banks = {
    capitec: 'capitec://',
    fnb: 'fnbapp://',
    nedbank: 'nedbank://'
  };
  window.open(banks[bank] || 'https://google.com/search?q=' + bank + '+app');
}

// Init
loadMilestones();
applySchool(); // load existing
</script>
</body>
</html>
