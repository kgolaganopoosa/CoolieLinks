<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Your CV – Coolie Links SA</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {background:#f8f9fa;font-family:'Segoe UI',sans-serif;}
        .cv-preview {background:white;color:#333;border:1px solid #ddd;box-shadow:0 10px 30px rgba(0,0,0,0.1);padding:40px;border-radius:12px;font-size:15px;}
        .cv-header {border-bottom:3px solid #f97316;padding-bottom:15px;margin-bottom:20px;}
        .section-title {color:#f97316;font-weight:600;border-bottom:2px solid #f97316;padding-bottom:5px;margin-top:30px;}
        .skill-tag {background:#e0e0e0;padding:5px 12px;border-radius:20px;font-size:13px;display:inline-block;margin:4px;}
        .btn-download {background:#f97316;color:white;border:none;padding:12px 30px;border-radius:50px;font-size:1.1rem;}
        .btn-download:hover {background:#f59e0b;}
    </style>
</head>
<body class="bg-light">

<div class="container py-5">
    <div class="row">
        <div class="col-lg-5">
            <h2 class="mb-4">Create Your CV</h2>
            <form id="cvForm">
                <h5>Personal Info</h5>
                <input type="text" class="form-control mb-3" placeholder="Full Name" id="fullName" required>
                <input type="text" class="form-control mb-3" placeholder="Profession / Title" id="title">
                <input type="email" class="form-control mb-3" placeholder="Email" id="email">
                <input type="tel" class="form-control mb-3" placeholder="Phone" id="phone">
                <input type="text" class="form-control mb-3" placeholder="City, Province" id="location">
                <textarea class="form-control mb-4" rows="3" placeholder="Short Bio (optional)" id="bio"></textarea>

                <h5 class="mt-4">Education</h5>
                <div id="educationFields">
                    <div class="education-entry mb-3 p-3 border rounded">
                        <input type="text" class="form-control mb-2" placeholder="Institution (e.g. UCT, Elangeni TVET)" required>
                        <input type="text" class="form-control mb-2" placeholder="Qualification (e.g. BCom, N6 Electrical)" required>
                        <input type="text" class="form-control" placeholder="Year (e.g. 2023 - 2025)">
                    </div>
                </div>
                <button type="button" class="btn btn-sm btn-outline-secondary mb-3" onclick="addEducation()">+ Add Education</button>

                <h5>Work Experience</h5>
                <div id="experienceFields">
                    <div class="experience-entry mb-3 p-3 border rounded">
                        <input type="text" class="form-control mb-2" placeholder="Job Title">
                        <input type="text" class="form-control mb-2" placeholder="Company Name">
                        <input type="text" class="form-control mb-2" placeholder="Location">
                        <input type="text" class="form-control mb-2" placeholder="Dates (e.g. Jan 2023 – Dec 2024)">
                        <textarea class="form-control" rows="2" placeholder="Key responsibilities & achievements"></textarea>
                    </div>
                </div>
                <button type="button" class="btn btn-sm btn-outline-secondary mb-3" onclick="addExperience()">+ Add Experience</button>

                <h5>Skills</h5>
                <input type="text" class="form-control mb-3" placeholder="Enter skills (comma separated)" id="skillsInput">
                
                <button type="button" class="btn btn-download w-100 mt-4" onclick="generateCV()">
                    Download CV as PDF
                </button>
            </form>
        </div>

        <div class="col-lg-7">
            <h2 class="mb-4">Preview</h2>
            <div id="cvPreview" class="cv-preview">
                <div class="text-center cv-header">
                    <h1 id="previewName" class="mb-1">Your Name</h1>
                    <p id="previewTitle" class="fs-4 text-muted">Your Profession</p>
                    <p id="previewContact" class="small">email | phone | location</p>
                </div>
                <p id="previewBio"></p>

                <h4 class="section-title">Education</h4>
                <div id="previewEducation"></div>

                <h4 class="section-title">Experience</h4>
                <div id="previewExperience"></div>

                <h4 class="section-title">Skills</h4>
                <div id="previewSkills"></div>
            </div>
        </div>
    </div>
</div>

<script src="https://html2pdf.js/v0.10.1/html2pdf.bundle.min.js"></script>
<script>
function addEducation() {
    const div = document.createElement("div");
    div.className = "education-entry mb-3 p-3 border rounded";
    div.innerHTML = `<input type="text" class="form-control mb-2" placeholder="Institution">
                     <input type="text" class="form-control mb-2" placeholder="Qualification">
                     <input type="text" class="form-control" placeholder="Year">`;
    document.getElementById("educationFields").appendChild(div);
}

function addExperience() {
    const div = document.createElement("div");
    div.className = "experience-entry mb-3 p-3 border rounded";
    div.innerHTML = `<input type="text" class="form-control mb-2" placeholder="Job Title">
                     <input type="text" class="form-control mb-2" placeholder="Company">
                     <input type="text" class="form-control mb-2" placeholder="Location">
                     <input type="text" class="form-control mb-2" placeholder="Dates">
                     <textarea class="form-control" rows="2" placeholder="Achievements"></textarea>`;
    document.getElementById("experienceFields").appendChild(div);
}

function generateCV() {
    document.getElementById("previewName").textContent = document.getElementById("fullName").value || "Your Name";
    document.getElementById("previewTitle").textContent = document.getElementById("title").value || "Professional";
    document.getElementById("previewContact").textContent = 
        `\( {document.getElementById("email").value} | \){document.getElementById("phone").value} | ${document.getElementById("location").value}`;
    document.getElementById("previewBio").textContent = document.getElementById("bio").value;

    // Education
    document.getElementById("previewEducation").innerHTML = "";
    document.querySelectorAll(".education-entry").forEach(entry => {
        const inst = entry.children[0].value;
        const qual = entry.children[1].value;
        const year = entry.children[2].value;
        if (inst && qual) {
            const p = document.createElement("p");
            p.innerHTML = `<strong>\( {qual}</strong><br> \){inst}<br><small class="text-muted">${year}</small><hr>`;
            document.getElementById("previewEducation").appendChild(p);
        }
    });

    // Experience
    document.getElementById("previewExperience").innerHTML = "";
    document.querySelectorAll(".experience-entry").forEach(entry => {
        const title = entry.children[0].value;
        if (title) {
            const div = document.createElement("div");
            div.innerHTML = `<strong>\( {title}</strong> – \){entry.children[1].value || ""}<br>
                            <small class="text-muted">\( {entry.children[2].value || ""} | \){entry.children[3].value || ""}</small>
                            <p>${entry.children[4].value || ""}</p><hr>`;
            document.getElementById("previewExperience").appendChild(div);
        }
    });

    // Skills
    const skills = document.getElementById("skillsInput").value.split(",").map(s => s.trim()).filter(s => s);
    document.getElementById("previewSkills").innerHTML = skills.map(s => `<span class="skill-tag">${s}</span>`).join(" ");

    // Generate PDF
    setTimeout(() => {
        const element = document.getElementById("cvPreview");
        html2pdf().from(element).set({
            margin: [0.5, 0.5, 0.5, 0.5],
            filename: `${document.getElementById("fullName").value || "My"}_CV.pdf`,
            html2canvas: { scale: 2 },
            jsPDF: { format: 'a4', orientation: 'portrait' }
        }).save();
    }, 500);
}

// Live preview on input
document.getElementById("cvForm").addEventListener("input", generateCV);
</script>
</body>
</html>
