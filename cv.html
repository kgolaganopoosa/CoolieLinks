<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Petal Chain - The Market</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />

  <!-- Google Font -->
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap"
    rel="stylesheet"
  />

  <style>
    :root {
      --pc-bg: #050505;
      --pc-card: #111111;
      --pc-accent: #ffffff;
      --pc-muted: #b3b3b3;
      --pc-border: #2b2b2b;
      --pc-highlight: #f5f5f5;
    }

    body {
      font-family: "Poppins", sans-serif;
      background: radial-gradient(circle at top, #202020 0, #000000 48%, #000 100%);
      color: var(--pc-accent);
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .pc-navbar {
      border-bottom: 1px solid var(--pc-border);
      backdrop-filter: blur(12px);
      background: rgba(0, 0, 0, 0.9);
    }

    .pc-brand-mark {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: 2px solid var(--pc-accent);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      margin-right: 8px;
    }

    .pc-title {
      letter-spacing: 0.08em;
      text-transform: uppercase;
      font-weight: 500;
      font-size: 0.9rem;
    }

    .pc-hero {
      padding: 2.5rem 1rem 1rem;
    }

    .pc-hero-title {
      font-size: 1.9rem;
      font-weight: 500;
    }

    .pc-hero-tagline {
      font-size: 0.98rem;
      color: var(--pc-muted);
      margin-top: 0.25rem;
    }

    .pc-catchphrase {
      margin-top: 0.8rem;
      font-size: 1rem;
      font-weight: 400;
      color: var(--pc-highlight);
      border-left: 2px solid #ffffff;
      padding-left: 0.75rem;
    }

    .pc-filters {
      margin-top: 1.5rem;
      margin-bottom: 1.3rem;
      background: rgba(5, 5, 5, 0.8);
      border-radius: 14px;
      border: 1px solid var(--pc-border);
      padding: 0.9rem;
    }

    .pc-search-input {
      background: #050505;
      border-radius: 999px !important;
      border: 1px solid var(--pc-border) !important;
      color: var(--pc-accent);
      font-size: 0.9rem;
    }

    .pc-item-card {
      background: var(--pc-card);
      border-radius: 18px;
      border: 1px solid var(--pc-border);
      padding: 0.8rem;
      height: 100%;
      transition: 0.2s ease;
    }

    .pc-item-card:hover {
      transform: translateY(-2px);
      border-color: #ffffff;
      box-shadow: 0 14px 30px rgba(0, 0, 0, 0.8);
    }

    .pc-item-img-wrapper {
      width: 100%;
      padding-top: 100%;
      border-radius: 14px;
      overflow: hidden;
      background: #000;
      border: 1px solid var(--pc-border);
      position: relative;
    }

    .pc-item-img-wrapper img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .pc-item-body {
      padding-top: 0.7rem;
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }

    .pc-actions {
      display: flex;
      gap: 0.4rem;
      margin-top: 0.45rem;
    }

    .pc-btn-buy {
      flex: 1;
      border-radius: 999px;
      border: 1px solid #ffffff;
      background: #ffffff;
      color: #000000;
      font-size: 0.8rem;
    }

    .pc-btn-cart {
      flex: 1;
      border-radius: 999px;
      border: 1px solid var(--pc-border);
      background: #050505;
      color: #ffffff;
      font-size: 0.8rem;
    }

    /* Cart Drawer */
    .pc-cart-drawer {
      position: fixed;
      top: 0;
      right: 0;
      width: 320px;
      max-width: 80vw;
      height: 100%;
      background: #050505;
      border-left: 1px solid var(--pc-border);
      transform: translateX(100%);
      transition: 0.25s ease;
      z-index: 1050;
      display: flex;
      flex-direction: column;
    }

    .pc-cart-drawer.open {
      transform: translateX(0);
    }

    .pc-cart-toggle-btn {
      position: fixed;
      bottom: 1.2rem;
      right: 1.2rem;
      background: #ffffff;
      color: #000000;
      border-radius: 999px;
      padding: 0.4rem 0.95rem;
      font-size: 0.85rem;
      display: flex;
      align-items: center;
      gap: 0.35rem;
      z-index: 1040;
    }

    footer {
      border-top: 1px solid var(--pc-border);
      padding: 1.2rem 1rem 1.4rem;
      text-align: center;
      font-size: 0.8rem;
      color: var(--pc-muted);
      background: #050505;
    }

    .pc-footer-logo {
      width: 26px;
      height: 26px;
      border-radius: 50%;
      border: 1px solid var(--pc-muted);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      margin-top: 0.35rem;
    }
  </style>
</head>

<body>

  <!-- NAVBAR -->
  <nav class="navbar navbar-dark pc-navbar">
    <div class="container-fluid px-3 px-md-4">
      <div class="d-flex align-items-center">
        <span class="pc-brand-mark">PC</span>
        <div class="d-flex flex-column">
          <h2 class="pc-title">Petal Chain</h2>
          <h4 style="font-size: 0.75rem; color: #aaaaaa;">The Market</h4>
        </div>
      </div>
    </div>
  </nav>

  <!-- HERO -->
  <section class="pc-hero container-fluid px-3 px-md-4">
    <h1 class="pc-hero-title">Petal Chain – The Market</h1>
    <p class="pc-hero-tagline">A minimal shelf of everyday essentials.</p>
    <p class="pc-catchphrase">“Pick your perfect pieces, and we’ll bring the market to your doorstep.”</p>

    <!-- FILTERS -->
    <div class="pc-filters">
      <div class="row g-2">
        <div class="col-12 col-md-6">
          <input type="text" id="searchInput" class="form-control pc-search-input"
            placeholder="Search by item or store name..." />
        </div>

        <div class="col-6 col-md-3">
          <select id="categoryFilter" class="form-control pc-search-input">
            <option value="all">All Categories</option>
            <option value="Dairy">Dairy</option>
            <option value="Drinks">Drinks</option>
            <option value="Snacks">Snacks</option>
            <option value="Bakery">Bakery</option>
            <option value="Fresh Produce">Fresh Produce</option>
            <option value="Household">Household</option>
          </select>
        </div>

        <div class="col-6 col-md-3">
          <select id="storeFilter" class="form-control pc-search-input">
            <option value="all">All Stores</option>
            <option value="Sunrise Grocers">Sunrise Grocers</option>
            <option value="Urban Sip Café">Urban Sip Café</option>
            <option value="Meadow Dairy Co.">Meadow Dairy Co.</option>
            <option value="Corner Cravings">Corner Cravings</option>
          </select>
        </div>
      </div>
    </div>
  </section>

  <!-- ITEMS -->
  <main class="container-fluid px-3 px-md-4">
    <div class="row g-3" id="itemsContainer"></div>
  </main>

  <!-- CART BUTTON -->
  <button class="pc-cart-toggle-btn" id="cartToggleBtn">
    Cart <span class="pc-cart-badge" id="cartCount">0</span>
  </button>

  <!-- CART DRAWER -->
  <div class="pc-cart-drawer" id="cartDrawer">
    <div class="pc-cart-header p-3 border-bottom">
      <span>Cart</span>
      <button class="btn btn-sm btn-outline-light rounded-pill" id="closeCartBtn">Close</button>
    </div>

    <div class="pc-cart-body p-3" id="cartItems"></div>

    <div class="pc-cart-footer p-3 border-top">
      <div class="d-flex justify-content-between mb-2">
        <span>Total</span>
        <span id="cartTotal">R0.00</span>
      </div>
      <button class="pc-btn-buy w-100" id="orderNowBtn">Order Now via WhatsApp</button>
    </div>
  </div>

  <!-- FOOTER -->
  <footer>
    <div>Petal Chain – The Market</div>
    <div class="pc-footer-logo">PC</div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    const WHATSAPP_NUMBER = "27824598656";

    const items = [
      { id: 1, name: "Fresh Full Cream Milk 2L", price: 36.99, category: "Dairy", store: "Meadow Dairy Co.", image: "https://images.pexels.com/photos/5947032/pexels-photo-5947032.jpeg?auto=compress&cs=tinysrgb&w=800" },
      { id: 2, name: "Classic Cheddar Cheese Block 500g", price: 74.5, category: "Dairy", store: "Meadow Dairy Co.", image: "https://images.pexels.com/photos/102128/pexels-photo-102128.jpeg?auto=compress&cs=tinysrgb&w=800" },
      { id: 3, name: "Sparkling Lemon Soda 330ml", price: 15.0, category: "Drinks", store: "Urban Sip Café", image: "https://images.pexels.com/photos/5531523/pexels-photo-5531523.jpeg?auto=compress&cs=tinysrgb&w=800" },
      { id: 4, name: "Cold Brew Coffee Bottle 250ml", price: 32.0, category: "Drinks", store: "Urban Sip Café", image: "https://images.pexels.com/photos/1749303/pexels-photo-1749303.jpeg?auto=compress&cs=tinysrgb&w=800" },
      { id: 5, name: "Sea Salt Kettle Chips 150g", price: 29.99, category: "Snacks", store: "Corner Cravings", image: "https://images.pexels.com/photos/6940994/pexels-photo-6940994.jpeg?auto=compress&cs=tinysrgb&w=800" },
      { id: 6, name: "Dark Chocolate Chunk Cookies", price: 39.0, category: "Bakery", store: "Corner Cravings", image: "https://images.pexels.com/photos/4109990/pexels-photo-4109990.jpeg?auto=compress&cs=tinysrgb&w=800" },
      { id: 7, name: "Country Sourdough Loaf", price: 42.5, category: "Bakery", store: "Corner Cravings", image: "https://images.pexels.com/photos/2092067/pexels-photo-2092067.jpeg?auto=compress&cs=tinysrgb&w=800" },
      { id: 8, name: "Crisp Green Apples (Pack of 6)", price: 34.99, category: "Fresh Produce", store: "Sunrise Grocers", image: "https://images.pexels.com/photos/672446/pexels-photo-672446.jpeg?auto=compress&cs=tinysrgb&w=800" },
      { id: 9, name: "Garden Fresh Tomatoes 1kg", price: 24.5, category: "Fresh Produce", store: "Sunrise Grocers", image: "https://images.pexels.com/photos/8390/food-wood-tomatoes.jpg?auto=compress&cs=tinysrgb&w=800" },
      { id: 10, name: "Household Paper Towels (2 Pack)", price: 38.0, category: "Household", store: "Sunrise Grocers", image: "https://images.pexels.com/photos/3965557/pexels-photo-3965557.jpeg?auto=compress&cs=tinysrgb&w=800" }
    ];

    let cart = [];

    function formatPrice(n) {
      return "R" + n.toFixed(2);
    }

    function getLocationForMessage(callback) {
      if (!navigator.geolocation) {
        callback(null);
        return;
      }

      navigator.geolocation.getCurrentPosition(
        pos => callback({ lat: pos.coords.latitude, lng: pos.coords.longitude }),
        () => callback(null)
      );
    }

    function openWhatsApp(message) {
      window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(message)}`, "_blank");
    }

    function renderItems() {
      const container = document.getElementById("itemsContainer");
      container.innerHTML = "";

      const search = document.getElementById("searchInput").value.toLowerCase();
      const category = document.getElementById("categoryFilter").value;
      const store = document.getElementById("storeFilter").value;

      const filtered = items.filter(i =>
        (category === "all" || i.category === category) &&
        (store === "all" || i.store === store) &&
        (i.name.toLowerCase().includes(search) || i.store.toLowerCase().includes(search))
      );

      filtered.forEach(item => {
        const col = document.createElement("div");
        col.className = "col-12 col-md-6";

        col.innerHTML = `
          <div class="pc-item-card">
            <div class="pc-item-img-wrapper">
              <img src="${item.image}" alt="${item.name}">
            </div>
            <div class="pc-item-body">
              <div class="pc-item-title">${item.name}</div>
              <div class="pc-item-meta d-flex justify-content-between">
                <span>${item.store}</span>
                <span>${item.category}</span>
              </div>
              <div class="d-flex justify-content-between align-items-center">
                <span class="pc-item-price">${formatPrice(item.price)}</span>
                <select class="pc-qty-select">
                  ${Array.from({ length: 12 }, (_, i) => `<option>${i + 1}</option>`).join("")}
                </select>
              </div>
              <div class="pc-actions">
                <button class="pc-btn-buy btn btn-sm">Buy Now</button>
                <button class="pc-btn-cart btn btn-sm">Add to Cart</button>
              </div>
            </div>
          </div>
        `;

        const qtySelect = col.querySelector(".pc-qty-select");
        const buyBtn = col.querySelector(".pc-btn-buy");
        const cartBtn = col.querySelector(".pc-btn-cart");

        buyBtn.addEventListener("click", () => {
          const qty = parseInt(qtySelect.value);
          const total = qty * item.price;

          getLocationForMessage(loc => {
            let locText = "Location: not shared";
            if (loc) {
              const url = `https://www.google.com/maps?q=${loc.lat},${loc.lng}`;
              locText = `Location: ${loc.lat.toFixed(5)}, ${loc.lng.toFixed(5)} (${url})`;
            }

            const msg = `
Hi, I’d like to buy this item from Petal Chain – The Market:

Item: ${item.name}
Store: ${item.store}
Category: ${item.category}
Quantity: ${qty}
Price each: ${formatPrice(item.price)}
Total: ${formatPrice(total)}

Image: ${item.image}

${locText}
            `.trim();

            openWhatsApp(msg);
          });
        });

        cartBtn.addEventListener("click", () => {
          const qty = parseInt(qtySelect.value);
          const existing = cart.find(c => c.id === item.id);

          if (existing) {
            existing.quantity += qty;
          } else {
            cart.push({ ...item, quantity: qty });
          }

          updateCartUI();
        });

        container.appendChild(col);
      });
    }

    function updateCartUI() {
      const cartItems = document.getElementById("cartItems");
      const cartTotal = document.getElementById("cartTotal");
      const cartCount = document.getElementById("cartCount");

      cartItems.innerHTML = "";

      let total = 0;
      let count = 0;

      cart.forEach(item => {
        const lineTotal = item.price * item.quantity;
        total += lineTotal;
        count += item.quantity;

        const div = document.createElement("div");
        div.className = "mb-3 border-bottom pb-2";

        div.innerHTML = `
          <div class="d-flex justify-content-between">
            <strong>${item.name}</strong>
            <span>x${item.quantity}</span>
          </div>
          <div class="d-flex justify-content-between text-muted">
            <span>${item.store}</span>
            <span>${formatPrice(item.price)} each</span>
          </div>
          <div class="d-flex justify-content-between mt-1">
            <strong>${formatPrice(lineTotal)}</strong>
            <button class="btn btn-sm btn-outline-light remove-btn">Remove</button>
          </div>
        `;

        div.querySelector(".remove-btn").addEventListener("click", () => {
          cart = cart.filter(c => c.id !== item.id);
          updateCartUI();
        });

        cartItems.appendChild(div);
      });

      cartTotal.textContent = formatPrice(total);
      cartCount.textContent = count;
    }

    document.getElementById("cartToggleBtn").addEventListener("click", () => {
      document.getElementById("cartDrawer").classList.add("open");
    });

    document.getElementById("
